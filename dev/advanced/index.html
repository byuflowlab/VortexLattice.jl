<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Advanced Usage · VortexLattice.jl</title><meta name="title" content="Advanced Usage · VortexLattice.jl"/><meta property="og:title" content="Advanced Usage · VortexLattice.jl"/><meta property="twitter:title" content="Advanced Usage · VortexLattice.jl"/><meta name="description" content="Documentation for VortexLattice.jl."/><meta property="og:description" content="Documentation for VortexLattice.jl."/><meta property="twitter:description" content="Documentation for VortexLattice.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">VortexLattice.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../guide/">Getting Started</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Advanced Usage</a><ul class="internal"><li><a class="tocitem" href="#Nonlinear-Vortex-Lattice"><span>Nonlinear Vortex Lattice</span></a></li><li><a class="tocitem" href="#Rotors"><span>Rotors</span></a></li></ul></li><li><a class="tocitem" href="../library/">Library</a></li><li><a class="tocitem" href="../theory/">Theory</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Advanced Usage</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Advanced Usage</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/VortexLattice.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/VortexLattice.jl/blob/master/docs/src/advanced.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Advanced-Use-Cases"><a class="docs-heading-anchor" href="#Advanced-Use-Cases">Advanced Use Cases</a><a id="Advanced-Use-Cases-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Use-Cases" title="Permalink"></a></h1><h2 id="Nonlinear-Vortex-Lattice"><a class="docs-heading-anchor" href="#Nonlinear-Vortex-Lattice">Nonlinear Vortex Lattice</a><a id="Nonlinear-Vortex-Lattice-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-Vortex-Lattice" title="Permalink"></a></h2><p>To incorporate airfoil polars a nonlinear vortex lattice method is used. In order to use this method system.sections must be correctly populated.</p><pre><code class="nohighlight hljs">system = System(grids; sections)</code></pre><p>sections is a vector of vector of SectionProperties objects. The length of grids and sections must be the same, for each grid there is a vector of SectionProperties. These vectors of section properties are created as follows:</p><pre><code class="nohighlight hljs">section = grid_to_sections(grid, airfoils)</code></pre><p>If grid is a 3 x n x m array, then airfoils is a vector of length m-1 with each object containing a CCBlade AlphaAF object that contains the polars for the airfoil. For more information see CCBlade.jl.</p><pre><code class="nohighlight hljs">system = System(grids; sections)
nonlinear_analysis!(system; max_iter=1, tol=1E-6, damping=0.01, print_iters=false)</code></pre><p>In the above example, leaving sections[2] empty implies that surface[2] does not have airfoils and does not need any nonlinear analysis.</p><p><strong>nonlinear_analysis!</strong> populates the sections with angles of attack, coefficients of lift and drag, and force-per-unit length normalized by the density (defaulted to 1) and the reference velocity.</p><h3 id="Warnings"><a class="docs-heading-anchor" href="#Warnings">Warnings</a><a id="Warnings-1"></a><a class="docs-heading-anchor-permalink" href="#Warnings" title="Permalink"></a></h3><p>Using a significant number of spanwise panels (more than 75) with non-uniform spacing may result in non-physical behavior at the ends of the surface. In this case it is recommended to use uniform spacing.</p><p>Increasing <strong>max_iter</strong> will result in a more accurate solution but may also introduce noise into the solution depending on the surface.</p><p>Default <strong>tol</strong> is designed to not be achieved so that <strong>max_iter</strong> determines the length of the nonlinear analysis. If noise is present in the solution the solution may diverge and convergence may be impossible without reducing the <strong>damping</strong>.</p><p>Increasing <strong>damping</strong> causes larger step sizes at each iteration. Larger step sizes may accelerate convergence but may also lead to noise solutions. </p><h2 id="Rotors"><a class="docs-heading-anchor" href="#Rotors">Rotors</a><a id="Rotors-1"></a><a class="docs-heading-anchor-permalink" href="#Rotors" title="Permalink"></a></h2><p>For convenience some functionality is provided for generating rotors that are compatible with the nonlinear vortex lattice analysis. <strong>generate_rotor</strong> provides grids, ratios, sections, and invert_normals that can be used to create the rotor in the system.</p><pre><code class="nohighlight hljs">grids, ratios, sections, invert_normals = generate_rotor(rotor_file, data_path)
system = System(grids; ratios, sections, invert_normals)</code></pre><h3 id="Rotor-file-structure"><a class="docs-heading-anchor" href="#Rotor-file-structure">Rotor file structure</a><a id="Rotor-file-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Rotor-file-structure" title="Permalink"></a></h3><p>This functionality requires a specific file system. Here is the file system for a simple rotor.</p><pre><code class="language-bash hljs">.
└── rotor_data
    ├── airfoils
    │   ├── my_airfoil.csv
    │   └── my_airfoil.dat
    └── rotors
        ├── my_rotor.csv
        ├── airfoils.csv
        ├── blade.csv
        ├── chorddist.csv
        ├── heightdist.csv
        ├── pitchdist.csv
        ├── sweepdist.csv
        └── centers.csv</code></pre><p>data<em>path points to the rotor</em>data folder, rotor<em>file is the name of the rotor file inside rotor</em>data/rotors, in this case filename is &quot;my_rotor.csv&quot;. Here is a list of the contents of each file with examples:</p><p>my_rotor.csv contains the radius of the hub and blade tip, the number of blades on the rotor, and the file that contains the rotor blade information.</p><pre><code class="nohighlight hljs">property,file,description
Rtip,0.75, (m) Radius of blade tip
Rhub,0.0375, (m) Radius of hub
B,3, Number of blades
blade,blade.csv, Blade file</code></pre><p>blade.csv contains files names for the chord, pitch, sweep, height, and airfoils for the blade and an optional file that defines the reference point on the airfoil for the measurements of pitch, sweep, and height. If centers.csv is not provided it defaults to the leading edge of the airfoil.</p><pre><code class="nohighlight hljs">property,file,description
chorddist,chorddist.csv, Chord distribution
pitchdist,pitchdist.csv, Pitch distribution
sweepdist,sweepdist.csv, LE sweep distribution
heightdist,heightdist.csv, LE height distribution
airfoil_files,airfoils.csv, Airfoil distribution
airfoil_reference,centers.csv,Airfoil references</code></pre><p>chorddist.csv, pitchdist.csv, sweepdist.csv, and heightdist.csv, each define the chord, pitch, sweep, and height of the airfoil normalized by the tip radius of the blade. Each file follows the same setup. Here is an example of the chorddist.csv file.</p><pre><code class="nohighlight hljs">r/R,c/R
0.0,0.134
0.086,0.137106
0.16,0.144606
...
1.0,0.0375</code></pre><p>As a note, all files (except airfoil_files.csv) should use the same r/R column (where R is the tip radius) while the second column will vary. The r/R column must always go from 0.0 to 1.0. The headings for the each column are arbitrary but headings must be provided.</p><p>airfoils.csv defines which airfoils are used along the length of the blade. The first column r/R does not need to match the other files. The contour file is the normalized contour of the airfoil, this is cuurently not used by VortexLattice.jl but the column is required but the files can be all zeros. The third column points to the files that define the polars of the airfoil.</p><pre><code class="nohighlight hljs">r/R,Contour file,Aero file
0.0,naca4412.csv,naca4412.dat
0.368421052631579,naca4412.csv,naca4412.dat
0.6842105263157894,naca4412.csv,naca4412.dat
0.8947368421052632,naca4412.csv,naca4412.dat
1.0,naca4412.csv,naca4412.dat</code></pre><p>Here is an example contour file:</p><pre><code class="nohighlight hljs">x/c,y/c
1.0,0.0012489471548600977
0.9983816051162109,0.0017436209477767937
0.996268484921455,0.0023275052942059735
...
1.0,-0.0012489471548600977</code></pre><p>Here is an example airfoil file. This file must follow the convention used in CCBlade.jl, though the Reynolds and Mach number are not used during calculation. The first line is an arbitrary information line, second line is Reynold number, the third is Mach number. The fourth line to the end contains the angle of attack, the coefficent of lift, and the coefficient of drag in that order.</p><pre><code class="nohighlight hljs">Polars info
0.0
0.0
-180.00000   0.00000   0.60000
-175.00000   0.00000   0.60000
-170.00000   0.00000   0.60000</code></pre><p>The airfoil_reference.csv file is an optional file with the intent of allowing the user to define height, sweep, and pitch at any point on the airfoil that is not the leading edge (as is common with wind turbines). The file format matches the height, sweep, and pitch files and so will not be shown here.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><a class="docs-footer-nextpage" href="../library/">Library »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 2 September 2025 17:47">Tuesday 2 September 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
